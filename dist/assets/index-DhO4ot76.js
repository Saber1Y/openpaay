import{d as p,B as R,g as C}from"./index-DmwHuDad.js";import{ax as u,ay as w,aA as S,aG as D,aw as A,aF as $}from"./index-8_JFJoco.js";import{M,O as I,N as G,Z}from"./bignumbers-DH8g2ZKA.js";import{t as q,a as J}from"./utf8-Buz2KJNa.js";import"./bn-D9Kp_-TR.js";const V="abi/5.8.0",_=new u(V),B={};let U={calldata:!0,memory:!0,storage:!0},H={calldata:!0,memory:!0};function b(a,e){if(a==="bytes"||a==="string"){if(U[e])return!0}else if(a==="address"){if(e==="payable")return!0}else if((a.indexOf("[")>=0||a==="tuple")&&H[e])return!0;return(U[e]||e==="payable")&&_.throwArgumentError("invalid modifier","name",e),!1}function K(a,e){let t=a;function s(o){_.throwArgumentError(`unexpected character at position ${o}`,"param",a)}a=a.replace(/\s/g," ");function i(o){let l={type:"",name:"",parent:o,state:{allowType:!0}};return e&&(l.indexed=!1),l}let n={type:"",name:"",state:{allowType:!0}},r=n;for(let o=0;o<a.length;o++){let l=a[o];switch(l){case"(":r.state.allowType&&r.type===""?r.type="tuple":r.state.allowParams||s(o),r.state.allowType=!1,r.type=y(r.type),r.components=[i(r)],r=r.components[0];break;case")":delete r.state,r.name==="indexed"&&(e||s(o),r.indexed=!0,r.name=""),b(r.type,r.name)&&(r.name=""),r.type=y(r.type);let c=r;r=r.parent,r||s(o),delete c.parent,r.state.allowParams=!1,r.state.allowName=!0,r.state.allowArray=!0;break;case",":delete r.state,r.name==="indexed"&&(e||s(o),r.indexed=!0,r.name=""),b(r.type,r.name)&&(r.name=""),r.type=y(r.type);let h=i(r.parent);r.parent.components.push(h),delete r.parent,r=h;break;case" ":r.state.allowType&&r.type!==""&&(r.type=y(r.type),delete r.state.allowType,r.state.allowName=!0,r.state.allowParams=!0),r.state.allowName&&r.name!==""&&(r.name==="indexed"?(e||s(o),r.indexed&&s(o),r.indexed=!0,r.name=""):b(r.type,r.name)?r.name="":r.state.allowName=!1);break;case"[":r.state.allowArray||s(o),r.type+=l,r.state.allowArray=!1,r.state.allowName=!1,r.state.readArray=!0;break;case"]":r.state.readArray||s(o),r.type+=l,r.state.readArray=!1,r.state.allowArray=!0,r.state.allowName=!0;break;default:r.state.allowType?(r.type+=l,r.state.allowParams=!0,r.state.allowArray=!0):r.state.allowName?(r.name+=l,delete r.state.allowArray):r.state.readArray?r.type+=l:s(o)}}return r.parent&&_.throwArgumentError("unexpected eof","param",a),delete n.state,r.name==="indexed"?(e||s(t.length-7),r.indexed&&s(t.length-7),r.indexed=!0,r.name=""):b(r.type,r.name)&&(r.name=""),n.type=y(n.type),n}function z(a,e){for(let t in e)p(a,t,e[t])}const m=Object.freeze({sighash:"sighash",minimal:"minimal",full:"full",json:"json"}),Q=new RegExp(/^(.*)\[([0-9]*)\]$/);class d{constructor(e,t){e!==B&&_.throwError("use fromString",u.errors.UNSUPPORTED_OPERATION,{operation:"new ParamType()"}),z(this,t);let s=this.type.match(Q);s?z(this,{arrayLength:parseInt(s[2]||"-1"),arrayChildren:d.fromObject({type:s[1],components:this.components}),baseType:"array"}):z(this,{arrayLength:null,arrayChildren:null,baseType:this.components!=null?"tuple":this.type}),this._isParamType=!0,Object.freeze(this)}format(e){if(e||(e=m.sighash),m[e]||_.throwArgumentError("invalid format type","format",e),e===m.json){let s={type:this.baseType==="tuple"?"tuple":this.type,name:this.name||void 0};return typeof this.indexed=="boolean"&&(s.indexed=this.indexed),this.components&&(s.components=this.components.map(i=>JSON.parse(i.format(e)))),JSON.stringify(s)}let t="";return this.baseType==="array"?(t+=this.arrayChildren.format(e),t+="["+(this.arrayLength<0?"":String(this.arrayLength))+"]"):this.baseType==="tuple"?(e!==m.sighash&&(t+=this.type),t+="("+this.components.map(s=>s.format(e)).join(e===m.full?", ":",")+")"):t+=this.type,e!==m.sighash&&(this.indexed===!0&&(t+=" indexed"),e===m.full&&this.name&&(t+=" "+this.name)),t}static from(e,t){return typeof e=="string"?d.fromString(e,t):d.fromObject(e)}static fromObject(e){return d.isParamType(e)?e:new d(B,{name:e.name||null,type:y(e.type),indexed:e.indexed==null?null:!!e.indexed,components:e.components?e.components.map(d.fromObject):null})}static fromString(e,t){function s(i){return d.fromObject({name:i.name,type:i.type,indexed:i.indexed,components:i.components})}return s(K(e,!!t))}static isParamType(e){return!!(e!=null&&e._isParamType)}}function y(a){return a.match(/^uint($|[^1-9])/)?a="uint256"+a.substring(4):a.match(/^int($|[^1-9])/)&&(a="int256"+a.substring(3)),a}const O=new u(V);class f{constructor(e,t,s,i){this.name=e,this.type=t,this.localName=s,this.dynamic=i}_throwError(e,t){O.throwArgumentError(e,this.localName,t)}}class T{constructor(e){p(this,"wordSize",e||32),this._data=[],this._dataLength=0,this._padding=new Uint8Array(e)}get data(){return D(this._data)}get length(){return this._dataLength}_writeData(e){return this._data.push(e),this._dataLength+=e.length,e.length}appendWriter(e){return this._writeData(A(e._data))}writeBytes(e){let t=w(e);const s=t.length%this.wordSize;return s&&(t=A([t,this._padding.slice(s)])),this._writeData(t)}_getValue(e){let t=w(R.from(e));return t.length>this.wordSize&&O.throwError("value out-of-bounds",u.errors.BUFFER_OVERRUN,{length:this.wordSize,offset:t.length}),t.length%this.wordSize&&(t=A([this._padding.slice(t.length%this.wordSize),t])),t}writeValue(e){return this._writeData(this._getValue(e))}writeUpdatableValue(){const e=this._data.length;return this._data.push(this._padding),this._dataLength+=this.wordSize,t=>{this._data[e]=this._getValue(t)}}}class N{constructor(e,t,s,i){p(this,"_data",w(e)),p(this,"wordSize",t||32),p(this,"_coerceFunc",s),p(this,"allowLoose",i),this._offset=0}get data(){return S(this._data)}get consumed(){return this._offset}static coerce(e,t){let s=e.match("^u?int([0-9]+)$");return s&&parseInt(s[1])<=48&&(t=t.toNumber()),t}coerce(e,t){return this._coerceFunc?this._coerceFunc(e,t):N.coerce(e,t)}_peekBytes(e,t,s){let i=Math.ceil(t/this.wordSize)*this.wordSize;return this._offset+i>this._data.length&&(this.allowLoose&&s&&this._offset+t<=this._data.length?i=t:O.throwError("data out-of-bounds",u.errors.BUFFER_OVERRUN,{length:this._data.length,offset:this._offset+i})),this._data.slice(this._offset,this._offset+i)}subReader(e){return new N(this._data.slice(this._offset+e),this.wordSize,this._coerceFunc,this.allowLoose)}readBytes(e,t){let s=this._peekBytes(0,e,!!t);return this._offset+=s.length,s.slice(0,e)}readValue(){return R.from(this.readBytes(this.wordSize))}}class X extends f{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){try{t=C(t)}catch(s){this._throwError(s.message,t)}return e.writeValue(t)}decode(e){return C($(e.readValue().toHexString(),20))}}class Y extends f{constructor(e){super(e.name,e.type,void 0,e.dynamic),this.coder=e}defaultValue(){return this.coder.defaultValue()}encode(e,t){return this.coder.encode(e,t)}decode(e){return this.coder.decode(e)}}const g=new u(V);function F(a,e,t){let s=null;if(Array.isArray(t))s=t;else if(t&&typeof t=="object"){let l={};s=e.map(c=>{const h=c.localName;return h||g.throwError("cannot encode object for signature with missing names",u.errors.INVALID_ARGUMENT,{argument:"values",coder:c,value:t}),l[h]&&g.throwError("cannot encode object for signature with duplicate names",u.errors.INVALID_ARGUMENT,{argument:"values",coder:c,value:t}),l[h]=!0,t[h]})}else g.throwArgumentError("invalid tuple value","tuple",t);e.length!==s.length&&g.throwArgumentError("types/value length mismatch","tuple",t);let i=new T(a.wordSize),n=new T(a.wordSize),r=[];e.forEach((l,c)=>{let h=s[c];if(l.dynamic){let L=n.length;l.encode(n,h);let P=i.writeUpdatableValue();r.push(W=>{P(W+L)})}else l.encode(i,h)}),r.forEach(l=>{l(i.length)});let o=a.appendWriter(i);return o+=a.appendWriter(n),o}function j(a,e){let t=[],s=a.subReader(0);e.forEach(n=>{let r=null;if(n.dynamic){let o=a.readValue(),l=s.subReader(o.toNumber());try{r=n.decode(l)}catch(c){if(c.code===u.errors.BUFFER_OVERRUN)throw c;r=c,r.baseType=n.name,r.name=n.localName,r.type=n.type}}else try{r=n.decode(a)}catch(o){if(o.code===u.errors.BUFFER_OVERRUN)throw o;r=o,r.baseType=n.name,r.name=n.localName,r.type=n.type}r!=null&&t.push(r)});const i=e.reduce((n,r)=>{const o=r.localName;return o&&(n[o]||(n[o]=0),n[o]++),n},{});e.forEach((n,r)=>{let o=n.localName;if(!o||i[o]!==1||(o==="length"&&(o="_length"),t[o]!=null))return;const l=t[r];l instanceof Error?Object.defineProperty(t,o,{enumerable:!0,get:()=>{throw l}}):t[o]=l});for(let n=0;n<t.length;n++){const r=t[n];r instanceof Error&&Object.defineProperty(t,n,{enumerable:!0,get:()=>{throw r}})}return Object.freeze(t)}class v extends f{constructor(e,t,s){const i=e.type+"["+(t>=0?t:"")+"]",n=t===-1||e.dynamic;super("array",i,s,n),this.coder=e,this.length=t}defaultValue(){const e=this.coder.defaultValue(),t=[];for(let s=0;s<this.length;s++)t.push(e);return t}encode(e,t){Array.isArray(t)||this._throwError("expected array value",t);let s=this.length;s===-1&&(s=t.length,e.writeValue(t.length)),g.checkArgumentCount(t.length,s,"coder array"+(this.localName?" "+this.localName:""));let i=[];for(let n=0;n<t.length;n++)i.push(this.coder);return F(e,i,t)}decode(e){let t=this.length;t===-1&&(t=e.readValue().toNumber(),t*32>e._data.length&&g.throwError("insufficient data length",u.errors.BUFFER_OVERRUN,{length:e._data.length,count:t}));let s=[];for(let i=0;i<t;i++)s.push(new Y(this.coder));return e.coerce(this.name,j(e,s))}}class ee extends f{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){return e.writeValue(t?1:0)}decode(e){return e.coerce(this.type,!e.readValue().isZero())}}class k extends f{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=w(t);let s=e.writeValue(t.length);return s+=e.writeBytes(t),s}decode(e){return e.readBytes(e.readValue().toNumber(),!0)}}class te extends k{constructor(e){super("bytes",e)}decode(e){return e.coerce(this.name,S(super.decode(e)))}}class re extends f{constructor(e,t){let s="bytes"+String(e);super(s,s,t,!1),this.size=e}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(e,t){let s=w(t);return s.length!==this.size&&this._throwError("incorrect data length",t),e.writeBytes(s)}decode(e){return e.coerce(this.name,S(e.readBytes(this.size)))}}class se extends f{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return t!=null&&this._throwError("not null",t),e.writeBytes([])}decode(e){return e.readBytes(0),e.coerce(this.name,null)}}class ne extends f{constructor(e,t,s){const i=(t?"int":"uint")+e*8;super(i,i,s,!1),this.size=e,this.signed=t}defaultValue(){return 0}encode(e,t){let s=R.from(t),i=M.mask(e.wordSize*8);if(this.signed){let n=i.mask(this.size*8-1);(s.gt(n)||s.lt(n.add(I).mul(G)))&&this._throwError("value out-of-bounds",t)}else(s.lt(Z)||s.gt(i.mask(this.size*8)))&&this._throwError("value out-of-bounds",t);return s=s.toTwos(this.size*8).mask(this.size*8),this.signed&&(s=s.fromTwos(this.size*8).toTwos(8*e.wordSize)),e.writeValue(s)}decode(e){let t=e.readValue().mask(this.size*8);return this.signed&&(t=t.fromTwos(this.size*8)),e.coerce(this.name,t)}}class ie extends k{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,q(t))}decode(e){return J(super.decode(e))}}class E extends f{constructor(e,t){let s=!1;const i=[];e.forEach(r=>{r.dynamic&&(s=!0),i.push(r.type)});const n="tuple("+i.join(",")+")";super("tuple",n,t,s),this.coders=e}defaultValue(){const e=[];this.coders.forEach(s=>{e.push(s.defaultValue())});const t=this.coders.reduce((s,i)=>{const n=i.localName;return n&&(s[n]||(s[n]=0),s[n]++),s},{});return this.coders.forEach((s,i)=>{let n=s.localName;!n||t[n]!==1||(n==="length"&&(n="_length"),e[n]==null&&(e[n]=e[i]))}),Object.freeze(e)}encode(e,t){return F(e,this.coders,t)}decode(e){return e.coerce(this.name,j(e,this.coders))}}const x=new u(V),ae=new RegExp(/^bytes([0-9]*)$/),oe=new RegExp(/^(u?int)([0-9]*)$/);class le{constructor(e){p(this,"coerceFunc",e||null)}_getCoder(e){switch(e.baseType){case"address":return new X(e.name);case"bool":return new ee(e.name);case"string":return new ie(e.name);case"bytes":return new te(e.name);case"array":return new v(this._getCoder(e.arrayChildren),e.arrayLength,e.name);case"tuple":return new E((e.components||[]).map(s=>this._getCoder(s)),e.name);case"":return new se(e.name)}let t=e.type.match(oe);if(t){let s=parseInt(t[2]||"256");return(s===0||s>256||s%8!==0)&&x.throwArgumentError("invalid "+t[1]+" bit length","param",e),new ne(s/8,t[1]==="int",e.name)}if(t=e.type.match(ae),t){let s=parseInt(t[1]);return(s===0||s>32)&&x.throwArgumentError("invalid bytes length","param",e),new re(s,e.name)}return x.throwArgumentError("invalid type","type",e.type)}_getWordSize(){return 32}_getReader(e,t){return new N(e,this._getWordSize(),this.coerceFunc,t)}_getWriter(){return new T(this._getWordSize())}getDefaultValue(e){const t=e.map(i=>this._getCoder(d.from(i)));return new E(t,"_").defaultValue()}encode(e,t){e.length!==t.length&&x.throwError("types/values length mismatch",u.errors.INVALID_ARGUMENT,{count:{types:e.length,values:t.length},value:{types:e,values:t}});const s=e.map(r=>this._getCoder(d.from(r))),i=new E(s,"_"),n=this._getWriter();return i.encode(n,t),n.data}decode(e,t,s){const i=e.map(r=>this._getCoder(d.from(r)));return new E(i,"_").decode(this._getReader(w(t),s))}}const me=new le;export{le as AbiCoder,m as FormatTypes,d as ParamType,me as defaultAbiCoder};
