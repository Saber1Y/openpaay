"use strict";var e=require("../core/config/config.js"),n=require("../core/errors/openfortError.js");exports.ProxyApi=class{backendApiClients;validateAndRefreshToken;ensureInitialized;getSignerSignFunction;constructor(e,n,t,i,r){this.backendApiClients=n,this.validateAndRefreshToken=t,this.ensureInitialized=i,this.getSignerSignFunction=r}async sendSignatureTransactionIntentRequest(t,i=null,r=null,s=!1){await this.ensureInitialized();if(!e.SDKConfiguration.getInstance())throw new n.OpenfortError("Configuration not found",n.OpenfortErrorType.INVALID_CONFIGURATION);await this.validateAndRefreshToken();let o=r;if(!o){if(!i)throw new n.OpenfortError("No signableHash or signature provided",n.OpenfortErrorType.OPERATION_NOT_SUPPORTED_ERROR);if(!this.getSignerSignFunction)throw new n.OpenfortError("In order to sign a transaction intent, a signer must be configured",n.OpenfortErrorType.MISSING_SIGNER_ERROR);const e=await this.getSignerSignFunction();o=await e(i)}const a={id:t,signatureRequest:{signature:o,optimistic:s}};return n.withOpenfortError(async()=>(await this.backendApiClients.transactionIntentsApi.signature(a)).data,{default:n.OpenfortErrorType.INTERNAL_ERROR})}async sendSignatureSessionRequest(e,t,i){await this.ensureInitialized();const r={id:e,signatureRequest:{signature:t,optimistic:i}};return n.withOpenfortError(async()=>(await this.backendApiClients.sessionsApi.signatureSession(r)).data,{default:n.OpenfortErrorType.INTERNAL_ERROR})}};
