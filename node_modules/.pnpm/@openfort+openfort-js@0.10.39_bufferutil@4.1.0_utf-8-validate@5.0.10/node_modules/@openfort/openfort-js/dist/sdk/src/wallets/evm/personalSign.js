import{hexToString as e}from"../../utils/crypto.js";import{JsonRpcError as s,RpcErrorCode as r}from"./JsonRpcError.js";import{signMessage as a}from"./walletHelpers.js";const t=async({params:t,signer:o,account:n})=>{const i=t[0],d=t[1];if(!d||!i)throw new s(r.INVALID_PARAMS,"personal_sign requires an address and a message");if(d.toLowerCase()!==n.address.toLowerCase())throw new s(r.INVALID_PARAMS,"personal_sign requires the signer to be the from address");const{hashMessage:p}=await import("@ethersproject/hash");return await a({hash:p(e(i)),implementationType:n.implementationType||n.type,chainId:Number(n.chainId),signer:o,address:d,salt:n.salt,factoryAddress:n.factoryAddress,ownerAddress:n.ownerAddress})};export{t as personalSign};
